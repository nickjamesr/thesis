\chapter{Tomography of Hamiltonians}
\label{ch:Hamiltomo}

\section{Introduction}
\label{sec:HTIntro}
In this chapter I discuss a procedure that I developed to determine the
(time constant) Hamiltonian governing the evolution of a system of
non-interacting Bosons in a discrete space. The process requires measurements of
single particle states and two particle correlations, and the number of
measurements scales polynomially with the number of system modes. It relies on
making measurements of the time evolution operator for multiple (minimum two,
preferably at least three) time increments.

In order to measure the time
evolution operator, I rely the method described in~\cite{sst} for efficiently
determining the unitary describing a linear optical circuit, or a similar
method. In section~\ref{sec:SST} I present a review of this method, and how it
is adapted to work in practice. Section~\ref{sec:Hamiltomo} describes in detail
the process for determining the Hamiltonian from multiple measurements of the
time evolution operator. Finally, section~\ref{sec:HTExperiment} contains
results of an experimental application of the process to a linear optical
quantum walk.

\section{Tomography of a unitary}
\label{sec:SST}
This section is a review of the method in~\cite{sst} for efficiently determining
the unitary description of a linear optical circuit. It is not my own work, but
it is important background for the results that follow.

\section{Tomography of a Hamiltonian}
\label{sec:Hamiltomo}
Now that we know we can determine the unitary description of a fixed quantum
process in linear optics, I apply this result to a general system of
non-interacting bosons evolving under a time-constant Hamiltonian in a discrete,
finite space. In particular, using measurements of the unitary time evolution
operator for the system at multiple time increments, we can deduce the
Hamiltonian underlying the evolution.

In practice, the experimental requirements are:
\begin{itemize}
  \item Preparation of arbitrary 1- and 2-particle states in the computational
  basis
  \item Precise control over the evolution time
  \item Arbitrary measurement of mode occupation and pairwise correlations
  between occupations (again, in the computational basis)
\end{itemize}

Recall that in a discrete, finite space of \(m\) orthogonal modes, the
Hamiltonian can be expressed exactly as an \(m \by m\) Hermitian matrix, and the
time evolution operator is an \(m \by m\) unitary matrix. If the Hamiltonian
\(\mat{H}\) is constant in time, the relationship between the time evolution
operator, \(\mat{U}\) and the Hamiltonian is:
\begin{equation}
  \label{eq:exponential}
  \mat{U} \of{t} = e^{-i \mat{H} t}
\end{equation}

Now consider taking the time derivative of this expression:
\begin{equation}
  \mat{U}^{\prime} \of{t} = -i \mat{H} e^{-i \mat{H} t} = -i \mat{H} \mat{U}
  \of{t}
\end{equation}
If we could measure \(\mat{U}^{\prime}\) directly, we would be done at this
point and the Hamiltonian would be revealed by:
\begin{equation}
  \mat{H} = i \mat{U}^{\prime} \of{t} \mat{U}^{\dagger} \of{t}
\end{equation}
for any time \(t\).

In order to avoid reliance on direct measurements of \(\mat{U}^{\prime}\), we
can instead discretise the derivative, and take multiple measurements of
\(\mat{U}\) in place of a single measurement of \(\mat{U}^{\prime}\). Here I
present the commonly-used 3-point time derivative, and derive the following
expression for \(\mat{H}\):
\begin{equation}
  \mat{H} = \frac{i}{2 \dt} \left[ \mat{U} \of{t+\dt} - \mat{U} \of{t-\dt}
  \right] \mat{U}^{\dagger} \of{t}
\end{equation}
Note that this is not the only way to recover the Hamiltonian from measurements
of \(\mat{U}\). Alternatives, such as the matrix logarithm and series expansions
are discussed briefly in section~\ref{sec:Alternatives}. The rest of this
section concerns the factors involved in choosing the step size, \(\dt\).
\begin{figure}[t]
  \centering
  \includegraphics{figures/timestep}
  \caption[Error in Hamiltonian reconstruction as a function of step size]
  {Error in Hamiltonian reconstruction as a function of step size, under varying
  noise from experimental error. All simulations are for a \(9 \by 9\)
  tridiagonal Hamiltonian, with noise applied directly to the unitary.
  In the absence of noise, the error in the
  reconstruction decreases as \(\dt^{2}\), since we are using the 3-point
  numerical derivative. In the presence of noise, there is an optimum point. For
  step sizes below this, the difference between the two unitaries being
  subtracted is swamped by the noise and the fidelity starts to decrease again.
  Shaded regions show \(1 \sigma\) variations over Monte-Carlo simulations of
  noise in the unitary.}
  \label{fig:stepsize}
\end{figure}


\section{Experimental implementation}
\label{sec:HTExperiment}
In photonics we have excellent sources and detectors, so the requirements of
arbitrary preparation and measurement in the computational basis are easy to
meet. The requirement that we have control over the evolution time is a more
difficult. In free space we could move the detectors closer to or further from
the source, but the Hamiltonian describing photons propagating in free space is
diagonal so the experiment would not be very interesting. Free space components
with more interesting Hamiltonians such as waveplates tend to be fixed, so we
have no control whatsoever over the evolution time!

A solution is presented in integrated optics. Consider a continuously coupled
quantum walk, where each waveguide is coupled to its nearest neighbour: the
effective evolution time is proportional to the optical path length of the
coupling region. We cannot easily vary the physical length of the coupling
region, but by varying the wavelength of the light, we can change the optical
length. It is using this technique that we perform the experiment described in
this section. Note that the setup and wavelength shifting of the source, and
most of the data acquisition was was done by PhD student Jacques Carolan. I did
the remaining data acquisition and all the data analysis.

\begin{figure}
  \centering
  \includegraphics[width=\textwidth]{figures/hamiltonians.png}
  \caption[Reconstructed Hamiltonians]
  {Hamiltonians reconstructed from the experimental data, for different choices
  of reference row and column in the unitary. Plots are labelled by the (column,
  row) combination used as a reference for signs. The colour scale indicates the
  absolute value of the element, from white (0) to blue (0.4). Tridiagonal
  character is most visible in the \(\left(8,3\right)\) and \(\left(8,4\right)\)
  plots.}
\end{figure}

\section{Alternative methods}
\label{sec:Alternatives}
\begin{figure}[t]
  \includegraphics{figures/logvsderivative}
  \caption[Comparison of power series and time derivative methods for
  Hamiltonian recovery]
  {Comparison of power series and time derivative as methods for Hamiltonian
  tomography, showing fidelity of the recovered Hamiltonian against the number
  of terms in the power series, for various levels of noise. Shaded regions show
  the fidelity expected from the time derivative method, with the variation
  being from Monte-Carlo simulation with 1000 random evaluations. This method
  does not involve summing terms so is constant. The error bars show the
  expected fidelity using a power series to evaluate the matrix logarithm to the
  expected number of terms. The fidelity flattens off due to noise accumulating
  for higher order terms in the series. The error bar on each point is
  calculated by a Monte-Carlo simulation of 1000 random evaluations.}
  \label{fig:logvsderivative}
\end{figure}
On inspection of equation~\ref{eq:exponential}, the most straightforward way to
recover the Hamiltonian from a measurement of \(\mat{U}\) would appear to be to
take the logarithm:
\begin{equation}
  \mat{H} = \frac{i}{t} \log \of{\mat{U} \of{t}}
\end{equation}
This can be performed either by diagonalising \(\mat{U}\) or by taking a series
expansion, both of which have their drawbacks. When diagonalising a unitary
matrix, all eigenvalues are unit-modulus complex numbers which permit a freedom
of \(\pm 2 n \pi\) when taking the logarithm. Therefore the resulting
Hamiltonian is not unique. The series expansion can only be used for small
times, requiring the Frobenius norm of \(\identity-\mat{A}\) to be less than
\(1\). More generally, since \(\mat{U} \of{\dt} = \mat{U} \of{t+\dt}
\mat{U}^{\dagger} \of{t}\) for any \(t\), we just require two measurements of
\(\mat{U}\) separated by a small time increment. This requirement is the same as
the time derivative method.

The relative merits of the time derivative compared to the series expansion
depend on the magnitude of this timestep and the amount of noise present in the
measurement of \(\mat{U}\). Simulations for a range of parameters are presented
in figure~\ref{fig:logvsderivative}, and show that for smaller timesteps the
time derivative can outperform the series method in the presence of experimental
noise. For larger timesteps, the series may be a better choice.

An alternative series-type solution has been described in~\cite{hamiltomo},
where the Hermitian and anti-Hermitian parts of \(\mat{U}\) are considered
separately.





