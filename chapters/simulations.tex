\chapter{Boson simulations}
\label{ch:Simulations}

\section{Introduction}
\label{sec:SimIntro}
Simulation of quantum systems, often the electronic energy states of molecules,
is a major challenge for classical computers, with even the fastest algorithms
falling short of polyomial scaling with the system size. Approximations can be
pretty good, but in the case of simulations of catalyst molecules, fall short
of the required precision for useful theoretical conclusions. \todo{This is
mostly based on the presentation at Microsoft - find some citations.} A solution
was proposed by Feynman \cite{qsim-feynman} in the early days of quantum
information science: use a quantum system to simulate other quantum systems.
Further study of quantum computing has formalised this idea and we now
understand that if we had sufficient control over one quantum system to build a
universal quantum computer, we could program it to simulate any other quantum
system.

I will refer to this method of simulation as \emph{digital} quantum simulation,
since it translates the dynamics of the simulated system into operations on
qubits: digital quantum information. The advantage of digital simulation is that
it is independent of the physical system implementing the qubits, which could be
anything from trapped ions to guided photons. Indeed, simulations of small
molecules have been performed in this way in linear optics~\cite{qsim-peruzzo}
and NMR~\cite{qsim-du} platforms \todo{and others?} This advantage is offset by
the large resource overheads required for the encoding. While some progress has
been made in reducing the overheads~\cite{qsim-poulin}, like any application
involving digital quantum computing, the technical challenge remains formidable.

An alternative approach to quantum simulation is the \emph{analogue} simulator.
While digital quantum simulation can be compared to modelling planetary motions
on a classical computer, analogue simulation bears more resemblance to an
orrery: a mechanical system that actually moves models of the planets. This may
seem like a primitive approach to simulation, but it has the advantage of
leveraging properties of the simulator to reduce the overheads in performing the
simulation. In this chapter, I discuss how to take advantage of the properties
of photons in linear optics to perform simulations of other systems of
non-interacting bosons without the overheads of a universal quantum computer.

By way of introduction, consider four broad categories of quantum objects.
First, group by exchange symmetry: Fermions and Bosons, then by interactions:
particles can interact with each other (e.g. charged particles via the
electromagnetic force) or not. If we can perform accurate simulations of
interacting systems, fermionic or bosonic, then we can simulate any quantum
system: this would effectively require a universal quantum computer. When
interactions can be ignored, we have a much more limited simulator, and if we
are further restricted to non-interacting Fermions, the system can be simulated
classically \todo{citation needed}. The final category---non-interacting
Bosons---is likely to yield more interesting results and since the recent
proposal of \bosonsampling{}~\cite{bosonsampling} appears to be intractable to
classical simulation under certain conditions.

Photons belong to this final class: they are Bosonic particles, and infamously
non-interacting (proposals for universal photonic quantum computers rely on
effective interactions via detection~\cite{klm}). The implication of this is
that with a relatively simple quantum computer (a system of photons in a large
interferometer) we can go beyond \bosonsampling{} and perform meaningful quantum
simulations. I discuss two specific instances of quantum simulations that I have
performed. In the first, we identify quantized molecular vibrations (phonons in
the harmonic limit) as another system of non-interacting bosons, susceptible to
our simulation method. This work is being prepared for publication, in
collaboration with Enrique Mart\'in L\'opez, Chris Sparrow and Anthony Laing.
In the second, we move away from closed quantum systems (Hermitian/unitary
dynamics) and consider a more abstract system of bosons obeying PT-symmetric
(non-Hermitian/non-unitary) dynamics. This work is being prepared for
publication in collaboration with Chris Sparrow, Anthony Laing and Yogesh
Jonglekar.

\begin{figure}[t]
  \centering
  \includegraphics{figures/circuit.pdf}
  \caption[A schematic of the bulk optics circuit used for simulations.]
  {A schematic of the bulk optics circuit. Two photons are injected at
  the left of the circuit in orthogonal polarisations (\(\ket{H}\) indicates
  horizontal and \(\ket{V}\) indicates vertical), using an in-fibre polarising
  beamsplitter (PBS) to combine the two photons into a single path. The circuit
  operates in a combined path/polarisation encoding, where polarising beam
  displacers (PBD) are used to convert between the two. Operations are performed
  with fixed quarter waveplates (QWP) and polarisation flips (X), and variable
  angle half waveplates (HWP). After the operations are complete,
  polarisation-sensitive detection is performed using further PBS elements and
  single photon avalanche diodes. We label the detectors A through D.}
  \label{fig:circuit}
\end{figure}

\section{Molecular vibrations}
\label{sec:Molecules}
\begin{figure}
  \centering
  \includegraphics{figures/molecules}
  \caption[Simulation of quantized vibrational states in molecules]
  {Simulation of quantized vibrational states in molecules. Blue is \co{} and
  green OCS. Lines represent the theoretically calculated evolution of the
  probabilities, with shaded regions showing \(\pm 1 \sigma\) expected due to
  errors in dialling. Points are experimentally measured, with error bars due to
  Poissonian noise too small to see at this scale.}
  \label{fig:molecules}
\end{figure}
In this section I present results from the quantum simulation of vibrational
states of molecules. The work is currently being prepared for publication. 
\begin{figure}[h]
  \centering
  \includegraphics{figures/vibrations.pdf}
  \caption[Vibrational modes of linear triatomic molecules]
  {Illustration of the vibrational modes of linear triatomic molecules. (a)
  Symmetric stretch, (b) Asymmetric stretch, (c) Bend. There are two
  (degenerate) bending modes, one in each of the two directions perpendicular to
  the axis of the molecule. In each case, the middle row shows the equilibrium
  positions of the atoms and the diagrams either side show the extremes of the
  motion.}
  \label{fig:vibrations}
\end{figure}

\section{PT-symmetric systems}
\label{sec:PT}
\subsection{Introduction}

On a disparate front, non-Hermitian Hamiltonians, \(\mat{H}_{\pt{}}\), that are
invariant under the combined parity \((\op{P})\) and time-reversal
\((\op{T})\) operations have been theoretically explored for more than a
decade \cite{bender98, levai-jphysa-33-7165, bender07}. Although not Hermitian,
such \(\pt{}\)-symmetric
Hamiltonians have a purely real spectrum that changes into complex-conjugate
eigenvalues as the non-Hermiticity is increased. When the spectrum of
\(\mat{H}_{\pt{}}\) is purely real, its non-orthogonal eigenvectors are
simultaneous eigenvectors of the \(\pt{}\) operation. However, when the spectrum
has complex conjugate eigenvalues, due to the anti-linear nature of the operator
\(\op{T}\), the eigenvectors are not \(\pt{}\) symmetric. This transition from
real to complex spectrum is called \(\pt{}\) symmetry breaking. 

It has been established that \(\pt{}\) symmetric theory is unlikely to be a
complete alternative to quantum mechanics, either reducing to the same thing
\cite{mostafazadeh-jmathphys-43-205} or producing non-physical results such as
violation of the no-signaling principle of relativity \cite{lee-prl-112-130404}.
However, it has recently become clear that it is far from being just a
mathematical curiosity: \(\pt{}\)-symmetric Hamiltonians model open
systems---classical or quantum---with balanced, spatially separated loss and
gain. They have been used to theoretically investigate vortex hopping in
superconductors \cite{naomichi-physrevlett-77-570},
statistical mechanics of Coulomb gases \cite{gulden-jetp-117-517} and
Non-equilibrium superconductivity \cite{rubinstein-physrevlett-99-167003,
serbyn-physrevb-87-020501}. During the past three years, the \(\pt{}\)
symmetry breaking has been experimentally investigated in classical systems
including two optical waveguides \cite{pt-ruter}, electrical circuits
\cite{schindler-physreva-84-040101}, mechanical systems
\cite{bender-amjphys-81-173} and discrete fiber networks
\cite{pt-regensburger}.

In this paper, we demonstrate the quantum simulation of non-interacting bosons
evolving under a \(\pt{}\) symmetric
Hamiltonian. We investigate the single-particle statistics and bosonic
correlations across the \(\pt{}\) symmetry breaking threshold. Although the time
evolution under \(\mat{H}_{\pt{}}\) is not unitary, by embedding this open
system into a larger, closed system, we demonstrate a general method for
simulating non-Hermitian Hamiltonians.

\begin{figure}[t]
  \centering
  \includegraphics{figures/opensystem}
  \caption[Representation of an open system]
  {Schematic representation of a simulation of an open system. We initialise a
  state in the system subspace, which then evolves under a non-Hermitian
  Hamiltonian to occupy a larger space. Detection on all output modes can reveal
  information about evolution into the environment subspace.}
  \label{fig:opensystem}
\end{figure}

\begin{figure}[t]
  \centering
  \includegraphics{figures/manifolds}
  \caption[Manifolds showing evolution of the PT-symmetric system]
  {Manifolds showing evolution of the \(\pt{}\)-symmetric system.}
  \label{fig:manifolds}
\end{figure}

\subsection{Two-site PT-symmetric model}
Let us consider a 2-site Hamiltonian with a tunneling \(J > 0\) between the two
sites and a \(\pt{}\)-symmetric potential \(\pm i \gamma\) on the two sites, \(
\mat{H} = -J \sigma_x -i \gamma \sigma_z\). The eigenvalues of this matrix are
\( \epsilon = \pm \sqrt{J^{2} - \gamma^{2}} \) which are real for \( J \geq
\gamma \), although the eigenvectors are not orthogonal to each other.

First, let us assume that the non-Hermitian term is small, i.e. \( \gamma \leq
J \) and \( \epsilon \) is real. In this case, we get the following
(non-unitary) time-evolution operator with \( \alpha = \epsilon \frac{t}{\hbar}
\)
\begin{equation}
  \mat{G}_{\leq} \of{t} = \begin{pmatrix}
    \cos \alpha - \frac{\gamma}{\epsilon} \sin \alpha &
    i \frac{J}{\epsilon} \sin \alpha \\
    i \frac{J}{\epsilon} \sin \alpha &
    \cos \alpha + \frac{\gamma}{\epsilon} \sin \alpha
  \end{pmatrix}
\end{equation}

In the limit where \( \gamma \rightarrow J_{-} \), \( \epsilon \rightarrow 0 \)
and \( \frac{1}{\epsilon} \sin \alpha \rightarrow \frac{t}{\hbar} \), thus at
the \(\pt{}\) phase boundary the time evolution operator becomes linear in time
instead of sinusoidal:
\begin{equation}
  \mat{G}_{\leq,-} = \begin{pmatrix}
    1-J\frac{t}{\hbar} & i J\frac{t}{\hbar} \\
    i J\frac{t}{\hbar} & 1+J\frac{t}{\hbar}
  \end{pmatrix}
\end{equation}
This also follows from the fact that \( \mat{H}^{2} = 0\) when \(J = \gamma\),
thus \( \mat{G}_{\leq} \of{t} \) truncates to the first two terms.

If we allow a large non-Hermitian term, \( \gamma \geq J \), then the
eigenvalues are purely imaginary, \( \epsilon = \pm i \sqrt{ \gamma^{2} - J^{2}
} = i \Gamma \). The corresponding eigenvectors are still not orthogonal. In
this case, the time evolution operator (with \( \beta = \Gamma \frac{t}{\hbar}
\)) is
\begin{equation}
  \mat{G}_{\geq} \of{t} = \begin{pmatrix}
    \cosh \beta - \frac{\gamma}{\Gamma} \sinh \beta &
    i \frac{J}{\Gamma} \sinh \beta \\
    i \frac{J}{\Gamma} \sinh \beta &
    \cosh \beta + \frac{\gamma}{\Gamma} \sinh \beta
  \end{pmatrix}
\end{equation}
In the limit where \( \gamma \rightarrow J_{+} \), \( \Gamma \rightarrow 0 \)
and \( \frac{1}{\Gamma} \sinh \beta \rightarrow \frac{t}{\hbar} \) thus at the
\(\pt{}\) phase boundary, we get a continuous time evolution operator,
\begin{equation}
  \left. \mat{G}_{\leq} \of{t} \right|_{\gamma \rightarrow J_{-}} = \left.
    \mat{G}_{\geq} \of{t} \right|_{\gamma \rightarrow J_{+}}
\end{equation}

The behaviour of this \(\pt{}\)-symmetric system can be understood by looking at
the occupation of (system or environment) modes when a particle initially in the
system is evolved under the non-Hermitian \(\mat{H}\). This will be a function
of the ratio \(\gamma/J\) as well as the time. In figure~\ref{fig:manifolds} we
illustrate this by setting \(J=1\) and showing the occupation of one of the
system modes as a function of time for a range of values of \(\gamma\). The
transition from \(\pt{}\) symmetric to \(\pt{}\) broken can be seen, and the
occupations are continuous over the boundary. Also shown are cross-sections
where experimental data are taken (see figure~\ref{fig:twosite} for full
experimental data).

\subsection{Unitary Dilation}
The simulation technique that we use requires that we embed the non-unitary
time-evolution operator into a larger, unitary operator. This can be done for
any matrix by doubling the dimension; that is, any \(n \by n\) matrix can be
embedded as an \(n \by n\) submatrix of a \(2n \by 2n\) unitary matrix. In order
to perform this embedding for a non-unitary matrix \(\mat{G}\), we must first
rescale it so that the operator norm is less than or equal to 1. A suitable
definition of operator norm in this case is \(\abs{\mat{G}} = \sqrt{\abs{e_{
\text{max}}}}\), where \(e_{\text{max}}\) is the largest eigenvalue of 
\(\mat{GG^{\dagger}}\) \cite{dilation}. The scaled matrix is then
\begin{equation}
  G_{s} = \frac{G}{\sqrt{\abs{e_{\text{max}}}}}
\end{equation}
and the unitary dilation can be expressed as follows:
\begin{equation}
  U = \begin{pmatrix}
    \mat{G}_{s} & \mat{D}\of{\mat{G}_{s}} \\
    \mat{D}\of{\mat{G}_{s}^{\dagger}} & -\mat{G}_{s}^{\dagger} \end{pmatrix}
\end{equation}
where \(\mat{D}\of{\mat{G}_{s}} = \left( \identity - \mat{G}_{s}\mat{G}_{s}^{
\dagger} \right)^{\half}
\) is the \emph{defect matrix} of \(\mat{G}_{s}\).

It can be verified by explicit calculation that \(\mat{U}\) is unitary.
Since \(\mat{G}_{s}\mat{G}_{s}^{\dagger}\) is always Hermitian, it always has
real eigenvalues and thus the defect matrix is well defined.

Physically, the interpretation of this unitary matrix corresponds to doubling
the number of available modes by introducing an \emph{enviroment} space, of
equal dimension to the \emph{system}. The rationalisation for this increase in
size being sufficient is that each system mode needs only one loss/gain channel
to realise arbitrary dynamics: adding more does not provide any additional
freedom.

The top left corner contains the matrix
\(\mat{G}_{s}\), which describes motion within the system and the bottom right
corner (\(-\mat{G}_{s}^{\dagger}\)) describes motion within the environment.
Since \(\mat{G}_{s}=\exp \of{-i\mat{H}t}\), the evolution of the environment,
\(\mat{-G}_{s}^{\dagger}=-\exp \of{i\mat{H}t}\), or the time-reversal of the
system's evolution (with a constant phase). The cross terms, \(\mat{D}
\of{\mat{G}_{s}}\) and \(\mat{D} \of{\mat{G}_{s}^{
\dagger}} \), describe the coupling between the system and environment. If
\(\mat{G}_{s}\) is already unitary, this coupling disappears, as expected:
unitary evolution applies to a closed system.

A consequence of this simulation method is that there is no effective
Hamiltonian that models the evolution of the closed system, i.e. no matrix
\(\mat{H}_{\eff}\) can satisfy
\begin{equation}
  U\of{t} = e^{-i\mat{H}_{\eff}t}
\end{equation}
for all times \(t\). This is evident when considering the initial time \(t=0\).
We would require
\begin{equation}
  \mat{U}\of{0} = \begin{pmatrix}
    \identity & 0 \\
    0 & -\identity
  \end{pmatrix}
\end{equation}
which cannot be achieved for any effective Hamiltonian. This observation implies
that the environment modes introduced for the simulation do not really
correspond to a real physical system; rather they are just a convenient way of
keeping track of gain and loss.

\begin{figure}[t]
  \centering
  \includegraphics{figures/twosite}
  \caption[Results of simulation]
    {Results of our experimental simulation. The top row (a-c) shows
    single photon data. The photon is initially injected in the system mode
    \(S_1\); probability of detection in each of the four modes \(\left\{S_1,
    S_2, E_1, E2\right\}\) after the evolution is shown. (a) is in the
    \(\pt{}\)-symmetric region (\(\gamma=0.95\)), where we observe periodic
    behaviour. (b) is on the \(\pt{}\) phase boundary (\(\gamma=1\)) and (c) is
    in the \(\pt{}\) broken region (\(\gamma=1.05\)). In both of these cases,
    the detection probabilities in our
    experiment tend towards a constant value, with any evolution after this
    point being purely due to the scale factor. The bottom row (d-f) shows
    two-particle data, where the particles are initially injected in the two
    system modes, \(S_1\) and \(S_2\). We show the detection probabilities for
    pairs where one photon is still in mode \(S_1\), and the other photon is in
    a different mode. (d) is in the \(\pt{}\)-symmetric region
    (\(\gamma=0.95\)), and again exhibits periodic behaviour. (e) is on the
    \(\pt{}\) phase boundary (\(\gamma=1\)) and (f) is in the \(\pt{}\)-broken
    region (\(\gamma=1.05\)). In all cases, the scale factor (black dashed
    line; on a different axis), has been separated out from the experimental
    observations, which reflect detection probabilities, rather than mode
    occupation.}
  \label{fig:twosite}
\end{figure}

\subsection{Our Simulation}
For our simulation we use a reconfigurable, four-mode photonic circuit in bulk
optics, shown in figure~\ref{fig:manifolds}(b). We map two of these optical
modes to the system and two to the environment, so the transformation performed
by the circuit is guaranteed to be unitary. By looking at detection events on
only the system modes, \(S_1\) and \(S_2\) we can observe (a scaled version of)
the evolution of the \(\pt{}\)-symmetric system, or by considering detection
events on any other modes, we can study the interaction between the system and
the environment. Note that when post-selecting on the system modes, there is a
non-unit probability of a detection event. In light of this, we could not
simulate the super-luminal signalling described in \cite{lee-prl-112-130404}.

The reconfigurability of our circuit is obtained by joint path/polarisation
operations. We can control the amplitudes at the output with half waveplates
(HWPs), and the phases with a series of three waveplates (QHQ): a half waveplate
between two quarter waveplates with the optic axis orientated at 45 degrees.
We use beam displacers (BDs) to convert between path and polarisation and
implement very stable Jamin-Lebedeff interferometers, while
polarisation-sensitive detection is achieved with in-fibre polarising
beamsplitters (PBS) and single-photon avalanche diodes (SPADs).

\subsection{Results}
The graphs in figure~\ref{fig:twosite} show the evolution of the 2-site system
at 3 points in the parameter space: \(\pt{}\)-symmetric, \(\gamma=0.95\) (a,d);
\(\pt{}\)-critical, \(\gamma=1.0\) (b,e) and \(\pt{}\)-broken, \(\gamma=1.05\)
(c,f). The scale factor (i.e. operator norm of the non-unitary matrix) has been
seperated from the experimental data for clarity. Consequently, the occupation
probabilities are always bounded between zero and one, and reflect the
probabilities of detecting photons in the relevant optical modes. On the other
hand, the scale factor is unbounded, and this is the origin of the quadratic or
exponential growth in the critical and \(\pt{}\) broken regions.

The top row (a-c) shows single-photon data, where the photon is injected into
system mode \(S_1\). Occupation probabilities for all output modes are shown.
The bottom row shows coincidental detections, where the photons are injected
into the two system modes, \(S_1\) and \(S_2\). We show occupation probabilities
for one photon in system mode \(S_1\) and the other photon in a different mode.
In both the \(\pt{}\)-critical and \(\pt{}\)-broken regions, the coincidental
detections between system and environment have very low probability.

Throughout all graphs, points represent experimental data (error bars due to
Poissonian noise are too small to see at this scale) and lines represent
theoretical expectations. The dashed black line (not on the same scale) is the
scale factor, and is unbounded.

To evaluate the fidelity of our simulations, we look at two measures. The first
is a trace distance between the unitary matrix that we intended to implement,
and the matrix that we in fact did implement, according to the data we collect
\todo{cite SST}. If the desired unitary is \(\mat{U}\) and the measured unitary
is \(\mat{U^{\prime}}\), the trace distance, \(F\) is defined by:
\[F=\frac{1}{2}\Tr\of{\mat{U}^{\dagger}{\mat{U}^{\prime}}}\]
The second measure we use compares (normalised) discrete probability
distributions, \(p\) and \(q\). This fidelity is computed as:
\[F=1-\frac{1}{2}\sum_{i}\abs{p_{i}-q_{i}}\]
This can be computed for the single photon data without any normalisation, since
detection probabilities in the four modes \(S_1\),\(S_2\),\(E_1\) and \(E_2\)
must sum to 1. In the case of coincidences, we only measure 6 out of the 10
possible pairings, so we must normalise these to 1 before computing the
fidelity.

In summary, the fidelities obtained are \(0.948 \pm 0.052\) for the trace
distance, \(0.956 \pm 0.020\) for the single photon data shown and \(0.961 \pm
0.014\) for the coincidences. Note that the figure for the coincidences takes
into account the \(S_2 E_1\), \(S_2 E_2\) and \(E_1 E_2\) correlations, which
are not presented here.

We have therefore demonstrated the ability to simulate the evolution of
\(\pt{}\)-symmetric systems in our 2-site model, across all regions of the phase
space. The cost of our implementation using linear optics and unitary dilation
is a doubling in the number of optical modes required, compared to the dimension
of the system we are simulating. However, with integrated optics
\todo{citations}, a constant-factor increase in number of modes is
straightforward to handle. In addition, our method of simulation allows the
number of particles to be scaled up, to the point where classical simulations
may become intractable.

\subsection{Experimental details}
\label{sec:SimulationExperiment}
The circuit shown in figure~\ref{fig:circuit} can be used to realise any
unitary operator in 4 modes, down to experimentally undetectable phases on the
input and output modes. This insensitivity to certain phases reduces the number
of parameters that we need to control to 7. All of the tunable parameters are
realised experimentally with half waveplates (HWPs), 5 of which control
amplitude splitting and the remaining 2 control internal phases
(interferometers). The calibration of the circuit is decribed in
section~\ref{sec:Calibration} of chapter~\ref{ch:QCV}.

The type-I spontaneous parametric down-conversion source used a 404nm
continuous-wave laser focused to a 40 \(\mu\)m waist in a \(\text{BiB}_3
\text{O}_6\) (Bismuth Triborate) non-linear crystal to produce pairs of
degenerate photons at 808nm. The photon pairs were filtered with high
transmission interference filters of 3nm spectral width and collected into
polarisation-maintaining optical fibres. Single-photon detection was achieved
using silicon-based avalanche photodiode single-photon counting modules.
Coincidence counting logic used a field-programmable gate array.


\subsubsection{Data acquisition}
For each unitary operator that we implement, we take one- and two-photon data.
The one-photon data are obtained by injecting one photon into the circuit, with
the other photon from the created pair acting as a herald, and counting
coincidental detections between them. An integration time of 30 seconds is used
for each of the two input modes ofthe circuit.
% NOTE: Remember that we take the one-photon data with 4 detectors, so we first
% herald with detector A and measure BCD and then herald with detector D and
% measure ABC.
The two-photon data consist of injecting both photons simultaneously then
delaying one photon from the pair with respect to the other to observe the
quantum to classical transition in photon correlations. This is done for each
pair of different output ports giving a total of six pairwise data sets in our
four-mode case. Two-photon data points were taken every 0.02mm over a range of
0.48mm with 20 seconds integration time.

Finally, we measure the relative detector efficiencies for the circuit. To do
this, we inject unheralded photons from one arm of the source through the input
mode \(S_1\), and direct them to each of the output ports in turn. The ratios of
counts at each of detectors \(S_2\), \(E_1\) and \(E_2\) to the counts at
detector \(S_1\) (after an integration time of 20 seconds and subtracting the
background of dark counts) give us the relevant efficiency data. We use this
measured efficiency data to correct both the one- and two-photon count numbers.

